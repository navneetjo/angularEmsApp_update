var mongoose=require("mongoose"),app=require("express")(),bodyParser=require("body-parser"),express=require("express");mongoose.connect("mongodb://172.27.59.61:27017/test");var db=mongoose.connection;console.log("connected to database"),console.log("in viewAll file"),db.once("open",function(){var e=new mongoose.Schema({code:Number,name:String,city:String});app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!0})),app.use(express.static(__dirname+"/public/html"));var o=mongoose.model("employee",e);app.get("/getData",function(e,n){o.find(function(e,o){return e?n.send(e):(console.log("message: "+o),n.json(o),n.end(),void 0)})}),app.get("/getData/:id",function(e,n){o.findOne({_id:e.params.id},function(e,o){return e?n.send(e):(console.log("message: "+o),n.json(o),n.end(),void 0)})}),app.post("/postData",function(e,n){var s=new o(e.body);s.code=e.body.code,s.name=e.body.name,s.city=e.body.city,s.save(function(e,o){e&&console.log("getting error"+e),console.log("getting data"+o),n.send({message:"Employee details added successfully"})})}),app.put("/update/:id",function(e,n){o.findOne({_id:e.params.id},function(o,s){console.log("complete data is ;- "+s),s.code=e.body.code,s.name=e.body.name,s.city=e.body.city,s.save(function(e){return e?n.send(e):(console.log("id"+s._id),console.log("Employee Code :- "+s.code),console.log("Name of Employee :- "+s.name),console.log("City :- "+s.city),n.json({message:"Employee details updated!"}),void 0)})})}),app.delete("/delete/:id",function(e,n){o.remove({_id:e.params.id},function(e){return e?n.send(e):(n.send({message:"Successfully deleted"}),void 0)})})}),app.set("port",process.env.PORT||3e3);var server=app.listen(app.get("port"),function(){console.log("Express server listening on port : "+server.address().port)});